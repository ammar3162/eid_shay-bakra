<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù…Ù†ØµØ© Ø§Ù„ØªÙ‡Ù†Ø¦Ø© Ø§Ù„Ø°ÙƒÙŠØ© | Ø§Ù†Ø´Ø± Ø§Ù„ÙØ±Ø­ ğŸ</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Amiri:wght@700&family=Cairo:wght@600;800&display=swap" rel="stylesheet">

<style>
:root{
--primary:#e11d48;
--dark:#1e293b;
--whatsapp:#25D366;
--bg:linear-gradient(135deg,#f1f5f9,#e2e8f0);
}

body{
font-family:'Cairo',sans-serif;
background:var(--bg);
margin:0;
display:flex;
align-items:center;
justify-content:center;
min-height:100vh;
padding:20px;
}

.main-wrapper{
background:#fff;
padding:30px;
border-radius:30px;
box-shadow:0 20px 40px rgba(0,0,0,.08);
width:100%;
max-width:480px;
text-align:center;
position:relative;
overflow:hidden;
}

.main-wrapper:before{
content:"";
position:absolute;
top:-80px;
right:-80px;
width:180px;
height:180px;
background:var(--primary);
opacity:.05;
border-radius:50%;
}

.joy-badge{
background:#fff1f2;
color:var(--primary);
padding:10px 18px;
border-radius:50px;
font-size:14px;
font-weight:800;
display:inline-flex;
gap:6px;
margin-bottom:25px;
}

#capture-area{
position:relative;
width:100%;
border-radius:20px;
overflow:hidden;
margin-bottom:25px;
}

#template-img{
width:100%;
display:block;
}

#display-name{
position:absolute;
bottom:20%;
left:50%;
transform:translateX(-50%);
width:85%;
font-family:'Amiri',serif;
font-size:clamp(28px,6vw,44px);
color:#fff;
text-shadow:0 4px 20px rgba(0,0,0,.6);
text-align:center;
transition:.3s;
}

input{
width:100%;
padding:18px;
border:2px solid #e2e8f0;
border-radius:15px;
font-size:18px;
text-align:center;
margin-bottom:15px;
}

.btn{
width:100%;
padding:18px;
border:none;
border-radius:15px;
font-weight:800;
font-size:17px;
cursor:pointer;
display:flex;
align-items:center;
justify-content:center;
gap:10px;
margin-bottom:12px;
transition:.2s;
}

.btn:hover{transform:translateY(-2px)}

.btn-share{
background:var(--whatsapp);
color:#fff;
}

.footer-text{
font-size:12px;
color:#94a3b8;
margin-top:20px;
font-weight:600;
}

#loading{
position:fixed;
top:0;left:0;
width:100%;height:100%;
background:rgba(0,0,0,.7);
display:none;
align-items:center;
justify-content:center;
color:#fff;
font-weight:800;
z-index:9999;
}
</style>
</head>

<body>

<div id="loading">â³ Ø¬Ø§Ø±ÙŠ ØªØ¬Ù‡ÙŠØ² Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©...</div>

<div class="main-wrapper">

<div class="joy-badge">
â¤ï¸ ØªÙ… Ù†Ø´Ø± Ø§Ù„ÙØ±Ø­ Ù„Ù€ <span id="joy-count">0</span> Ø´Ø®Øµ
</div>

<div id="capture-area">
<img id="template-img" src="eid_koshary.jpg">
<div id="display-name">Ø§Ø³Ù…Ùƒ Ù‡Ù†Ø§</div>
</div>

<input type="text" id="nameInput" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ Ø§Ù„ÙƒØ±ÙŠÙ…..." maxlength="25">

<button class="btn btn-share" id="shareBtn" onclick="handleShare()">
ğŸ“² Ø´Ø§Ø±Ùƒ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨
</button>

<div class="footer-text">
ÙƒÙ„ Ø¹Ø§Ù… ÙˆØ£Ù†ØªÙ… Ø¨Ø®ÙŠØ± Â© 2026
</div>

</div>

<script>
/* ===== Ø¹Ø¯Ø§Ø¯ Ù…Ø­ÙÙˆØ¸ ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­ ===== */
let joyCount = localStorage.getItem("joyCount");
if(!joyCount){
joyCount = 1280 + Math.floor(Math.random()*50);
}
joyCount++;
localStorage.setItem("joyCount", joyCount);

animateCounter(parseInt(joyCount));

function animateCounter(target){
let current=0;
const step=Math.ceil(target/40);
const int=setInterval(()=>{
current+=step;
if(current>=target){
current=target;
clearInterval(int);
}
document.getElementById("joy-count").innerText=
current.toLocaleString('ar-SA');
},20);
}

/* ===== ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø§Ø³Ù… ===== */
document.getElementById("nameInput").addEventListener("input",e=>{
document.getElementById("display-name").innerText=
e.target.value || "Ø§Ø³Ù…Ùƒ Ù‡Ù†Ø§";
});

/* ===== Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© ÙƒØµÙˆØ±Ø© Ù…Ø¨Ø§Ø´Ø±Ø© ===== */
let generatedBlob=null;

async function handleShare(){
const name = document.getElementById("nameInput").value.trim();
if(!name){
alert("Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ Ø£ÙˆÙ„Ø§Ù‹ â¤ï¸");
return;
}

document.getElementById("loading").style.display="flex";

/* Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØµÙˆØ±Ø© */
const canvas = await html2canvas(
document.getElementById("capture-area"),
{scale:3,useCORS:true}
);

canvas.toBlob(async blob=>{
generatedBlob = blob;
const file = new File([generatedBlob], `Ø¹ÙŠØ¯_Ù…Ø¨Ø§Ø±Ùƒ_${name}.png`, {type:"image/png"});

/* Ù…Ø´Ø§Ø±ÙƒØ© Ù…Ø¨Ø§Ø´Ø±Ø© Ù„Ùˆ ÙŠØ¯Ø¹Ù… Ø§Ù„Ø¬Ù‡Ø§Ø² */
if(navigator.canShare && navigator.canShare({ files:[file] })){
try{
await navigator.share({
title: "Ø¹ÙŠØ¯ Ù…Ø¨Ø§Ø±Ùƒ ğŸ‰",
text: "ÙƒÙ„ Ø¹Ø§Ù… ÙˆØ£Ù†ØªÙ… Ø¨Ø®ÙŠØ± âœ¨",
files: [file]
});
}catch(err){
console.log("ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©");
}
} else {
/* fallback Ù†ØµÙŠ Ù„Ùˆ Ø§Ù„Ø¬Ù‡Ø§Ø² Ù„Ø§ ÙŠØ¯Ø¹Ù… Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ù…Ù„ÙØ§Øª */
alert("Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„ØµÙˆØ± ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…Ø© Ø¹Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ø¬Ù‡Ø§Ø²ØŒ Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù‡Ø§ØªÙ Ø§Ù„Ø¬ÙˆØ§Ù„.");
}

document.getElementById("loading").style.display="none";
},'image/png',1);
}
</script>

</body>
</html>
